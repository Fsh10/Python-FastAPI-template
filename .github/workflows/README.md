# GitHub Actions Workflows

## Deploy Workflow

Workflow для автоматического деплоя на сервер через SSH.

### Настройка секретов в GitHub

Для работы workflow необходимо настроить следующие секреты в настройках репозитория (Settings → Secrets and variables → Actions):

1. **SSH_PRIVATE_KEY** - Приватный SSH ключ для подключения к серверу
2. **SSH_HOST** - IP адрес или доменное имя сервера
3. **SSH_USER** - Имя пользователя для SSH подключения
4. **SSH_PORT** (опционально) - Порт SSH (по умолчанию 22)
5. **DEPLOY_PATH** (опционально) - Путь к директории проекта на сервере (по умолчанию `/var/www/app`)

### Генерация SSH ключа

Если у вас еще нет SSH ключа:

```bash
ssh-keygen -t ed25519 -C "github-actions" -f ~/.ssh/github_actions_deploy
```

Затем добавьте публичный ключ на сервер:

```bash
ssh-copy-id -i ~/.ssh/github_actions_deploy.pub user@your-server.com
```

Или вручную:

```bash
cat ~/.ssh/github_actions_deploy.pub | ssh user@your-server.com "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"
```

### Настройка сервера

1. Убедитесь, что на сервере установлен Git
2. Убедитесь, что на сервере установлен Poetry (если используется)
3. Убедитесь, что пользователь имеет права на выполнение команд в директории проекта
4. Настройте права доступа к директории проекта

### Триггеры

Workflow запускается автоматически при:
- Push в ветки `main` или `master`
- Ручном запуске через GitHub Actions UI (workflow_dispatch)

### Примечания

- Workflow не перезапускает приложение автоматически (согласно правилам проекта)
- Для перезапуска приложения используйте команды вручную на сервере
- Все команды выполняются с правами указанного SSH пользователя


